# 무대공연 시나리오 뷰어 — 원페이지 블로그형 스크롤 PRD

## 프로젝트 개요
- 목적: 대본·이미지·연출노트를 한 흐름으로 읽는 모바일 최적화 원페이지 뷰어
- 특징: 카드 구분 없는 롱폼(블로그형) 스크롤, 부드러운 전환, 최소한의 경계
- 타깃: 연출/스태프/출연진(내부 공유), 시사회 대상(외부 공유)

## 핵심 목표
- 모바일 중심 가독성 높은 대본 읽기
- 본문 흐름 속 자연스러운 이미지/영상 삽입
- 장면 간 빠른 점프 네비게이션 제공
- 부드러운 스크롤/전환, 최소한의 시각적 소음

## 범위(스코프)
- 포함: 원페이지 장면 뷰, 이미지 확대, 유튜브 임베드, 토글형 연출노트, 장면 네비
- 제외: 계정/권한, 댓글/협업, 서버 CMS, 오프라인(캐싱 최소)

## 콘텐츠 소스
- 대본: `public/script.md` (사용자 제공)
- 이미지: `public/01.png` ~ `public/09.png`
- 영상: 제공된 2개 링크(장면 연출노트의 “레퍼런스”로 임베드)
  - https://www.youtube.com/watch?v=1ReuOnKSi0s
  - https://youtu.be/ZrflpPulnDU?si=7ccZaCwZhsa8HB9-

## 콘텐츠 구조
- 장면(Scene)
  - 헤더: 장면 번호, 제목(필수)
  - 본문: 대본 텍스트(마크다운 지원)
  - 이미지: 본문 중간 삽입(슬롯 규칙으로 배치)
  - 연출노트: 토글로 접기/펼치기
  - 레퍼런스 동영상: YouTube 임베드(0~N개)
- 페이지 상단: 작품 제목/소개(선택), 전체 목차(TOC, 모바일 접힘)
- 페이지 하단: 전역 레퍼런스/크레딧(선택)

## 마크다운 파싱 규칙(제안)
- 장면 구분: `## 1. 장면 제목` 형식의 H2를 장면 시작으로 인식
- 본문: 일반 마크다운 문단/인라인 문법 허용
- 이미지 슬롯(간편 규칙): 단독 줄에 `_`만 있는 경우, 등장 순서대로 `01.png` → `02.png` → … 자동 매핑
- 이미지 슬롯(명시 규칙, 선택): `[img:NN]` 표기 시 `public/NN.png` 매핑 우선
- 연출노트 블록: `> Note:` 로 시작하는 인용 블록을 “연출노트”로 인식(블록 끝까지)
- 노트 내 영상: 유튜브 URL 포함 시 자동 임베드(멀티 라인 지원)
- 전역 레퍼런스: 장면별 노트에 없을 경우, 제공된 2개 링크를 페이지 하단 전역 레퍼런스로 노출

## 정보 구조(IA)
- 상단: 제목/소개 → (모바일) 접히는 목차
- 본문: Scene 01 → Scene 02 → … → Scene N
- 하단: 전역 레퍼런스(선택) → 크레딧/푸터

## 네비게이션
- 목차(TOC): 장면 제목 목록, 탭/아코디언 형태(모바일), 스크롤스파이 표시
- 점프: 각 장면에 `#scene-01` 같은 앵커 부여, TOC/상단으로 이동 버튼 제공
- 브라우저 히스토리: 장면 진입 시 해시 업데이트(뒤로가기 동작 일관)

## 레이아웃/타이포그래피
- 모바일 퍼스트: 본문 폭 `~640px` 컨테이너, 좌우 넉넉한 여백
- 타이포: 본문 16–18px, 행간 1.8 내외, 제목 대비 1.25–1.5배
- 색상: 흑백/단색 기조, `currentColor` 기반 은은한 보조 배경(필요 시)
- 경계: 구분선 미사용, 장면 간 상하 간격과 미세한 페이드로 연결감 표현

## 시각/인터랙션
- 장면 전환: CSS 트랜지션 또는 `motion`으로 미세한 페이드/트랜스폼
- 이미지: 탭/클릭 시 라이트박스 확대, 핀치줌(모바일) 지원
- 연출노트: 디폴트 접힘, 토글 시 부드러운 높이/알파 애니메이션
- 동영상: 유튜브 플레이어 기본 컨트롤, 지연 로딩(IntersectionObserver)

## 컴포넌트(초안)
- `SceneSection`: 장면 컨테이너, 앵커/제목/본문/미디어/노트 슬롯
- `Prose`: 대본 타이포 스타일 래퍼(롱폼 가독성)
- `ImageInline`: 본문 흐름 내 이미지 + 캡션(선택) + 확대
- `DirectorNote`: 토글 가능 패널, 내부에 링크/영상 리스트 렌더
- `YouTubeEmbed`: URL → ID 파싱, 응답형(16:9), 썸네일 프리뷰(선택)
- `TOC`: 제목/현재 위치 표시, 모바일 접힘, 스크롤스파이
- `Lightbox`: 포털 마운트, 제스처/키보드 닫기

## Aceternity UI 연동 가이드(컴포넌트 매핑)
- 사용 원칙
  - Aceternity UI 컴포넌트를 우선 활용하되, SSR/접근성 보장을 최우선으로 채택
  - Tailwind v4 유틸리티(@utility)와 프로젝트 토큰을 유지하며 스타일 재정의 최소화
  - 배경/마스크 효과는 이미 추가한 `bg-dot`, `bg-grid`, `mask-radial` 유틸로 일관 적용
- 매핑 제안(유연 적용)
  - 연출노트 토글: Accordion/Collapsible 계열 컴포넌트 사용 → `DirectorNote` 래핑
  - 이미지 확대: Modal/Dialog 또는 Lightbox 계열 컴포넌트 사용 → `Lightbox` 구현에 결합
  - 장면 전환 연출: Sticky/Reveal/Container-Scroll 계열 컴포넌트로 미세한 등장 효과 적용(과도한 패럴럭스 지양)
  - 빠른 이동 네비: Floating Dock/Minimal Navbar 계열을 모바일 하단 고정 네비로 활용(TOC와 해시 점프 연동)
  - 카드/배경: Background Patterns(그리드/도트)와 Radial Mask 유틸 결합, 구분선 없이 섹션 연결감 강조
- 접근성/성능
  - 키보드 포커스 이동, `aria-expanded`/`aria-modal` 등 내장 속성 유지
  - 인터섹션 관찰로 지연 로딩(이미지/영상), 스크롤스파이만 클라이언트 사이드

## 디자인 토큰/유틸리티
- Tailwind v4 사용(이미 구성됨). 가독성 중심 `prose` 유사 스타일 수기 정의
- 배경 유틸(선택적 사용): `bg-dot`, `bg-grid`, `mask-radial`로 은은한 질감/페이드
- 다크 모드: `.dark` 루트 전환(이미 환경 구성), 대비/가독성 우선

## 접근성
- 키보드 포커스 이동, 라이트박스/토글/임베드 조작 가능
- 토글 버튼 `aria-expanded`, 라이트박스 포커스 트랩/ESC 닫기
- 이미지 `alt`, 영상 `title`/자막 권장
- 색 대비 WCAG AA 이상

## 성능
- 이미지: `next/image`로 응답형·지연 로드, `public/NN.png` 사용
- 영상: 뷰포트 진입 시 로드(프리뷰 → 플레이어 전환)
- 스크롤스파이/라이트박스만 클라이언트 컴포넌트, 나머지 서버 렌더 우선
- 번들: 외부 라이브러리 최소화, CSS 유틸 재사용

## 기술 스택/구조(제안)
- Next.js(App Router), React 19, Tailwind v4
- 파일 배치
  - `app/page.tsx`: 페이지 조립(서버 컴포넌트), `script.md` 파싱
  - `lib/parse-script.ts`: 마크다운 → Scene[] 파서
  - `components/*`: 위 컴포넌트 분리
  - 자산: `public/script.md`, `public/01.png`~`09.png`

## 파싱 방식(상세)
- 서버 컴포넌트에서 `fs`로 `public/script.md` 읽기
- 규칙에 따라 Scene 모델 생성 → 렌더

## 데이터 모델
```ts
type Scene = {
  id: string;        // 'scene-01'
  index: number;     // 1
  slug: string;      // 'scene-01-제목'
  title: string;     // 장면 제목
  bodyHtml: string;  // 마크다운 → HTML
  images: string[];  // '/01.png' 등
  notesHtml?: string;
  videos: string[];  // 유튜브 ID/URL 목록
}
```
- 이미지 매핑: 간편 슬롯 순서 매핑 기본, `[img:NN]` 우선
- 영상: 노트 블록 내 URL 자동 추출/임베드. 미지정 시 전역 레퍼런스 하단 노출

## 수용 기준(Acceptance Criteria)
- 모바일(375px)에서 스크롤만으로 장면 5개 이상 읽기 편함
- 각 장면에 앵커 존재, TOC에서 해당 장면으로 점프 가능
- 본문 중간 이미지가 자연스럽게 흐름에 삽입되고 탭 시 확대됨
- 연출노트가 접힘 상태로 로드되고 토글 시 부드럽게 열림
- 유튜브 링크가 임베드로 표시되고, 뷰포트 진입 전까지 로드하지 않음
- 장면 사이 전환이 과도하지 않고 미세한 페이드로 연결
- 다크·라이트 모두 가독성 AA 이상

## 테스트 시나리오
- `script.md`에서 `_` 슬롯 3개 → `01/02/03.png` 순서대로 매핑 확인
- `[img:07]` 표기 시 해당 위치에 `07.png` 우선 배치
- 유튜브 URL이 텍스트로만 있을 때도 임베드 변환
- TOC 항목 탭 → 해시/포커스 이동, 스크롤스파이 활성 표기
- 라이트박스 열기/ESC/백드롭·제스처로 닫기
- 저사양 모바일에서 60fps 스크롤 유지(이미지/영상 지연 로딩)

## 향후 확장
- 장면 메타데이터 프런트매터(시간/배역/장소) 도입
- 인물 하이라이트(검색/필터), 북마크, 공유 해시
- 노출용/내부용 뷰 모드 스위치

## 구현 순서(제안)
1) `lib/parse-script.ts` 파서 설계/구현
2) `components` 생성(TOC, SceneSection, ImageInline, DirectorNote, YouTubeEmbed, Lightbox)
3) `app/page.tsx`에서 서버 렌더 파이프 연결
4) 기본 스타일/인터랙션 적용 후 시각 검수
